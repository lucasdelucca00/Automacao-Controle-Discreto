/*
 * Arquivo:C:/Users/cinar/SUPREMICA_SUMO/pratica 4/pratica_4.c
 * Código Gerado para a familia MSP430Gxx com saída Mealy
 * Foi utilizado listas encadeadas como jogador de autômato
 * Desenvolvido por César Rafael Claure Torrico.
 */
#include "msp430.h"
// Dados do autômato (Não pode ser declarado dentro da função main por ser const)
#define NTRANS 1354	// Número de Transições
#define NESTADOS 696	// Número de Estados
#define BUFFER 10	// Máximo Número de Eventos no Buffer

const unsigned int event[NTRANS]={0,0,0,0,3,0,3,0,3,0,3,0,3,0,0,3,0,3,0,0,0,0,3,0,0,3,0,0,3,0,0,0,3,0,3,0,3,0,0,3,0,0,3,0,0,3,0,0,0,0,3,
		0,3,0,3,0,0,0,0,3,0,3,0,3,0,0,3,0,0,3,0,0,0,3,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,7,0,7,0,7,0,7,0,7,0,7,0,
		7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,
		0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
		7,0,7,0,7,0,7,0,7,0,7,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,
		0,6,0,6,0,6,0,6,0,6,7,0,6,7,0,6,7,0,6,7,0,6,7,0,6,7,0,6,7,0,6,7,0,6,7,0,6,7,0,6,7,0,6,7,0,6,7,0,6,7,0,
		6,7,0,6,7,0,6,7,0,6,7,0,6,7,0,6,7,0,6,7,0,6,7,0,6,7,0,6,7,0,5,0,5,0,5,0,5,0,5,0,5,0,5,0,5,0,5,0,5,0,5,
		0,5,0,5,0,5,0,5,0,5,0,5,0,5,0,5,0,5,0,5,0,5,0,5,0,5,0,5,7,0,5,7,0,5,7,0,5,7,0,5,7,0,5,7,0,5,7,0,5,7,0,
		5,7,0,5,7,0,5,7,0,5,7,0,5,7,0,5,7,0,5,7,0,5,7,0,5,7,0,5,7,0,5,7,0,5,7,0,5,7,0,5,7,0,5,7,0,5,7,0,5,6,0,
		5,6,0,5,6,0,5,6,0,5,6,0,5,6,7,0,5,6,7,0,5,6,7,0,5,6,7,0,5,6,7,4,4,4,3,4,3,4,3,4,3,4,3,4,4,3,4,3,4,4,4,
		4,3,4,4,3,4,4,3,4,4,4,3,4,3,4,3,4,4,3,4,4,3,4,4,3,4,4,4,4,3,4,3,4,3,4,4,4,4,3,4,3,4,3,4,4,3,4,4,3,4,4,
		4,3,4,4,4,4,3,4,4,4,4,4,4,4,4,4,4,4,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,
		7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,
		4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,7,4,6,4,6,4,6,4,6,4,
		6,4,6,4,6,4,6,4,6,4,6,4,6,4,6,4,6,4,6,4,6,4,6,4,6,4,6,4,6,4,6,4,6,4,6,4,6,4,6,4,6,7,4,6,7,4,6,7,4,6,7,
		4,6,7,4,6,7,4,6,7,4,6,7,4,6,7,4,6,7,4,6,7,4,6,7,4,6,7,4,6,7,4,6,7,4,6,7,4,6,7,4,6,7,4,6,7,4,6,7,4,6,7,
		4,6,7,4,6,7,4,6,7,4,5,4,5,4,5,4,5,4,5,4,5,4,5,4,5,4,5,4,5,4,5,4,5,4,5,4,5,4,5,4,5,4,5,4,5,4,5,4,5,4,5,
		4,5,4,5,4,5,4,5,7,4,5,7,4,5,7,4,5,7,4,5,7,4,5,7,4,5,7,4,5,7,4,5,7,4,5,7,4,5,7,4,5,7,4,5,7,4,5,7,4,5,7,
		4,5,7,4,5,7,4,5,7,4,5,7,4,5,7,4,5,7,4,5,7,4,5,7,4,5,7,4,5,6,4,5,6,4,5,6,4,5,6,4,5,6,4,5,6,7,4,5,6,7,4,
		5,6,7,4,5,6,7,4,5,6,7,1,2,1,2,1,2,3,3,3,3,3,2,3,3,2,1,2,1,3,2,3,1,3,1,2,3,3,3,1,3,1,3,1,3,1,2,2,3,3,3,
		2,2,2,3,3,3,1,3,1,2,3,2,1,2,3,2,1,2,1,3,1,2,1,1,1,2,1,2,1,2,2,1,1,2,1,2,7,1,2,7,1,2,7,7,7,7,7,7,2,7,7,
		7,2,7,1,2,7,1,7,7,2,7,7,1,7,7,1,7,2,7,7,7,7,1,7,7,1,7,7,1,7,7,1,7,2,7,2,7,7,7,7,2,7,2,7,2,7,7,7,7,1,7,
		7,1,2,7,7,2,7,1,2,7,7,2,7,1,2,7,1,7,7,1,2,7,1,7,1,7,1,2,7,1,2,7,1,7,2,7,2,7,1,7,1,2,7,1,6,6,6,6,6,6,6,
		6,6,6,6,6,6,1,6,6,6,6,1,6,1,6,1,6,6,6,6,6,1,6,7,6,7,6,7,6,7,6,7,6,7,6,7,6,7,6,7,6,7,6,7,6,7,6,7,1,6,7,
		6,7,6,7,6,7,1,6,7,1,6,7,1,6,7,6,7,6,7,6,7,6,7,2,5,5,5,5,5,5,5,5,5,5,5,5,2,5,5,2,5,5,2,5,5,5,2,5,5,5,5,
		5,2,5,7,5,7,5,7,5,7,5,7,5,7,5,7,5,7,5,7,5,7,5,7,5,7,2,5,7,5,7,2,5,7,5,7,2,5,7,5,7,5,7,2,5,7,5,7,5,7,5,
		7,5,7,5,6,5,6,5,6,5,6,5,6,5,6,7,5,6,7,5,6,7,5,6,7,5,6,7};
const unsigned int in_state[NTRANS]={232,233,234,235,122,236,121,237,119,238,118,239,114,240,241,112,242,113,243,244,245,246,63,247,248,63,249,250,63,251,252,253,63,254,117,255,120,256,257,63,258,259,63,260,261,63,262,263,264,265,63,
		266,107,267,109,268,269,270,271,63,272,63,273,63,274,275,63,276,277,110,278,279,280,94,281,282,283,284,116,285,286,287,288,289,290,291,292,293,294,295,0,296,1,297,2,298,3,299,4,300,5,301,
		6,302,7,303,8,304,9,305,10,306,11,307,12,308,13,309,14,310,15,311,16,312,17,313,18,314,19,315,20,316,21,317,22,318,23,319,24,320,25,321,26,322,27,323,28,324,29,325,30,326,31,
		327,32,328,33,329,34,330,35,331,36,332,37,333,38,334,39,335,40,336,41,337,42,338,43,339,44,340,45,341,46,342,47,343,48,344,49,345,50,346,51,347,52,348,53,349,54,350,55,351,56,352,
		57,353,58,354,59,355,60,356,61,357,62,358,12,359,45,360,6,361,40,362,4,363,52,364,16,365,21,366,32,367,29,368,35,369,41,370,39,371,62,372,8,373,60,374,37,375,42,376,19,377,26,
		378,11,379,20,380,7,381,10,382,75,126,383,108,127,384,69,128,385,103,129,386,67,130,387,115,131,388,79,132,389,84,133,390,95,134,391,92,135,392,98,136,393,104,137,394,102,138,395,125,139,396,
		71,140,397,123,141,398,100,142,399,105,143,400,82,144,401,89,145,402,74,146,403,83,147,404,70,148,405,73,149,406,1,407,34,408,5,409,23,410,14,411,18,412,22,413,25,414,27,415,33,416,48,
		417,43,418,36,419,30,420,38,421,28,422,2,423,24,424,17,425,15,426,61,427,13,428,3,429,9,430,64,174,431,97,175,432,68,176,433,86,177,434,77,178,435,81,179,436,85,180,437,88,181,438,
		90,182,439,96,183,440,111,184,441,106,185,442,99,186,443,93,187,444,101,188,445,91,189,446,65,190,447,87,191,448,80,192,449,78,193,450,124,194,451,76,195,452,66,196,453,72,197,454,127,177,455,
		136,197,456,138,185,457,128,180,458,132,182,459,151,201,222,460,160,221,223,461,162,209,224,462,152,204,225,463,156,206,226,464,465,466,354,467,353,468,351,469,350,470,346,471,472,344,473,345,474,475,476,
		477,295,478,479,295,480,481,295,482,483,484,295,485,349,486,352,487,488,295,489,490,295,491,492,295,493,494,495,496,295,497,339,498,341,499,500,501,502,295,503,295,504,295,505,506,295,507,508,342,509,510,
		511,326,512,513,514,515,348,516,517,518,519,520,521,522,523,524,525,526,527,232,528,233,529,234,530,235,531,236,532,237,533,238,534,239,535,240,536,241,537,242,538,243,539,244,540,245,541,246,542,247,543,
		248,544,249,545,250,546,251,547,252,548,253,549,254,550,255,551,256,552,257,553,258,554,259,555,260,556,261,557,262,558,263,559,264,560,265,561,266,562,267,563,268,564,269,565,270,566,271,567,272,568,273,
		569,274,570,275,571,276,572,277,573,278,574,279,575,280,576,281,577,282,578,283,579,284,580,285,581,286,582,287,583,288,584,289,585,290,586,291,587,292,588,293,589,294,590,244,591,277,592,238,593,272,594,
		236,595,284,596,248,597,253,598,264,599,261,600,267,601,273,602,271,603,294,604,240,605,292,606,269,607,274,608,251,609,258,610,243,611,252,612,239,613,242,614,307,358,615,340,359,616,301,360,617,335,361,
		618,299,362,619,347,363,620,311,364,621,316,365,622,327,366,623,324,367,624,330,368,625,336,369,626,334,370,627,357,371,628,303,372,629,355,373,630,332,374,631,337,375,632,314,376,633,321,377,634,306,378,
		635,315,379,636,302,380,637,305,381,638,233,639,266,640,237,641,255,642,246,643,250,644,254,645,257,646,259,647,265,648,280,649,275,650,268,651,262,652,270,653,260,654,234,655,256,656,249,657,247,658,293,
		659,245,660,235,661,241,662,296,406,663,329,407,664,300,408,665,318,409,666,309,410,667,313,411,668,317,412,669,320,413,670,322,414,671,328,415,672,343,416,673,338,417,674,331,418,675,325,419,676,333,420,
		677,323,421,678,297,422,679,319,423,680,312,424,681,310,425,682,356,426,683,308,427,684,298,428,685,304,429,686,359,409,687,368,429,688,370,417,689,360,412,690,364,414,691,383,433,454,692,392,453,455,693,
		394,441,456,694,384,436,457,695,388,438,458,174,126,175,127,176,128,586,585,583,582,578,129,576,577,130,177,131,178,527,132,527,179,527,180,133,527,581,584,181,527,182,527,183,527,184,134,135,527,571,573,
		136,137,138,527,527,527,185,527,186,139,574,140,187,141,558,142,188,143,189,580,190,144,191,192,193,145,194,146,195,147,148,196,197,149,198,150,464,199,151,465,200,152,466,467,468,469,470,471,153,472,473,
		474,154,475,201,155,476,202,477,478,156,479,480,203,481,482,204,483,157,484,485,486,487,205,488,489,206,490,491,207,492,493,208,494,158,495,159,496,497,498,499,160,500,161,501,162,502,503,504,505,209,506,
		507,210,163,508,509,164,510,211,165,511,512,166,513,212,167,514,213,515,516,214,168,517,215,518,216,519,217,169,520,218,170,521,219,522,171,523,172,524,220,525,221,173,526,222,476,509,470,504,468,516,480,
		485,496,493,499,505,503,223,526,472,524,501,224,506,225,483,226,490,475,484,471,474,227,539,590,572,591,533,592,567,593,531,594,579,595,543,596,548,597,559,598,556,599,562,600,568,601,566,602,228,589,603,
		535,604,587,605,564,606,229,569,607,230,546,608,231,553,609,538,610,547,611,534,612,537,613,222,465,498,469,487,478,482,486,489,491,497,512,507,223,500,494,224,502,492,225,466,488,481,226,479,525,477,467,
		473,227,528,638,561,639,532,640,550,641,541,642,545,643,549,644,552,645,554,646,560,647,575,648,570,649,228,563,650,557,651,229,565,652,555,653,230,529,654,551,655,544,656,231,542,657,588,658,540,659,530,
		660,536,661,591,641,600,661,602,649,592,644,596,646,615,665,686,624,685,687,626,673,688,616,668,689,620,670,690};
const unsigned int rfirst[NESTADOS] = {1,2,3,5,7,9,11,13,14,16,18,19,20,21,23,24,26,27,29,30,31,33,35,37,38,40,41,43,44,46,47,48,49,51,53,55,56,57,58,60,62,64,65,67,68,70,71,72,74,75,76,
		77,79,80,81,82,83,84,85,86,87,88,89,91,93,95,97,99,101,103,105,107,109,111,113,115,117,119,121,123,125,127,129,131,133,135,137,139,141,143,145,147,149,151,153,155,157,159,161,163,165,167,
		169,171,173,175,177,179,181,183,185,187,189,191,193,195,197,199,201,203,205,207,209,211,213,215,217,219,221,223,225,227,229,231,233,235,237,239,241,243,245,247,249,251,253,255,257,259,261,263,266,269,272,
		275,278,281,284,287,290,293,296,299,302,305,308,311,314,317,320,323,326,329,332,335,337,339,341,343,345,347,349,351,353,355,357,359,361,363,365,367,369,371,373,375,377,379,381,383,386,389,392,395,398,401,
		404,407,410,413,416,419,422,425,428,431,434,437,440,443,446,449,452,455,458,461,464,467,470,474,478,482,486,490,491,492,493,495,497,499,501,503,504,506,508,509,510,511,513,514,516,517,519,520,521,523,525,
		527,528,530,531,533,534,536,537,538,539,541,543,545,546,547,548,550,552,554,555,557,558,560,561,562,564,565,566,567,569,570,571,572,573,574,575,576,577,578,579,581,583,585,587,589,591,593,595,597,599,601,
		603,605,607,609,611,613,615,617,619,621,623,625,627,629,631,633,635,637,639,641,643,645,647,649,651,653,655,657,659,661,663,665,667,669,671,673,675,677,679,681,683,685,687,689,691,693,695,697,699,701,703,
		705,707,709,711,713,715,717,719,721,723,725,727,729,731,733,735,737,739,741,743,745,747,749,751,753,756,759,762,765,768,771,774,777,780,783,786,789,792,795,798,801,804,807,810,813,816,819,822,825,827,829,
		831,833,835,837,839,841,843,845,847,849,851,853,855,857,859,861,863,865,867,869,871,873,876,879,882,885,888,891,894,897,900,903,906,909,912,915,918,921,924,927,930,933,936,939,942,945,948,951,954,957,960,
		964,968,972,976,980,982,984,986,987,988,989,990,991,992,993,994,995,997,998,999,1000,1001,1002,1003,1004,1005,1006,1007,1008,1009,1010,1011,1012,1013,1014,1015,1016,1017,1018,1019,1020,1021,1022,1023,1024,1025,1026,1027,1028,1030,1031,
		1032,1034,1035,1036,1038,1039,1040,1042,1043,1044,1046,1048,1049,1050,1051,1052,1054,1057,1060,1063,1064,1065,1066,1067,1068,1070,1071,1072,1074,1077,1079,1080,1082,1083,1085,1086,1088,1090,1091,1092,1093,1095,1096,1098,1099,1101,1102,1104,1106,1108,1109,
		1110,1111,1113,1115,1117,1118,1119,1120,1122,1123,1126,1127,1129,1132,1133,1135,1138,1140,1141,1144,1146,1148,1151,1154,1156,1158,1160,1162,1165,1167,1168,1169,1170,1171,1172,1173,1174,1175,1176,1177,1178,1179,1181,1182,1183,1184,1186,1188,1190,1191,1192,
		1193,1194,1197,1199,1201,1203,1205,1207,1209,1211,1213,1215,1217,1219,1221,1224,1226,1228,1230,1233,1236,1239,1241,1243,1245,1247,1249,1250,1251,1252,1253,1254,1255,1256,1257,1258,1259,1260,1262,1263,1265,1266,1268,1269,1270,1272,1273,1274,1275,1276,1279,
		1281,1283,1285,1287,1289,1291,1293,1295,1297,1299,1301,1304,1306,1309,1311,1314,1316,1318,1321,1323,1325,1327,1329,1331,1333,1335,1337,1339,1342,1345,1348,1351,1354};
const unsigned int rnext[NTRANS] = {0,0,0,0,4,0,6,0,8,0,10,0,12,0,0,15,0,17,0,0,0,0,22,0,0,25,0,0,28,0,0,0,32,0,34,0,36,0,0,39,0,0,42,0,0,45,0,0,0,0,50,
		0,52,0,54,0,0,0,0,59,0,61,0,63,0,0,66,0,0,69,0,0,0,73,0,0,0,0,78,0,0,0,0,0,0,0,0,0,0,0,90,0,92,0,94,0,96,0,98,0,100,0,
		102,0,104,0,106,0,108,0,110,0,112,0,114,0,116,0,118,0,120,0,122,0,124,0,126,0,128,0,130,0,132,0,134,0,136,0,138,0,140,0,142,0,144,0,146,0,148,0,150,0,152,
		0,154,0,156,0,158,0,160,0,162,0,164,0,166,0,168,0,170,0,172,0,174,0,176,0,178,0,180,0,182,0,184,0,186,0,188,0,190,0,192,0,194,0,196,0,198,0,200,0,202,0,
		204,0,206,0,208,0,210,0,212,0,214,0,216,0,218,0,220,0,222,0,224,0,226,0,228,0,230,0,232,0,234,0,236,0,238,0,240,0,242,0,244,0,246,0,248,0,250,0,252,0,254,
		0,256,0,258,0,260,0,262,0,264,265,0,267,268,0,270,271,0,273,274,0,276,277,0,279,280,0,282,283,0,285,286,0,288,289,0,291,292,0,294,295,0,297,298,0,300,301,0,303,304,0,
		306,307,0,309,310,0,312,313,0,315,316,0,318,319,0,321,322,0,324,325,0,327,328,0,330,331,0,333,334,0,336,0,338,0,340,0,342,0,344,0,346,0,348,0,350,0,352,0,354,0,356,
		0,358,0,360,0,362,0,364,0,366,0,368,0,370,0,372,0,374,0,376,0,378,0,380,0,382,0,384,385,0,387,388,0,390,391,0,393,394,0,396,397,0,399,400,0,402,403,0,405,406,0,
		408,409,0,411,412,0,414,415,0,417,418,0,420,421,0,423,424,0,426,427,0,429,430,0,432,433,0,435,436,0,438,439,0,441,442,0,444,445,0,447,448,0,450,451,0,453,454,0,456,457,0,
		459,460,0,462,463,0,465,466,0,468,469,0,471,472,473,0,475,476,477,0,479,480,481,0,483,484,485,0,487,488,489,0,0,0,0,494,0,496,0,498,0,500,0,502,0,0,505,0,507,0,0,
		0,0,512,0,0,515,0,0,518,0,0,0,522,0,524,0,526,0,0,529,0,0,532,0,0,535,0,0,0,0,540,0,542,0,544,0,0,0,0,549,0,551,0,553,0,0,556,0,0,559,0,
		0,0,563,0,0,0,0,568,0,0,0,0,0,0,0,0,0,0,0,580,0,582,0,584,0,586,0,588,0,590,0,592,0,594,0,596,0,598,0,600,0,602,0,604,0,606,0,608,0,610,0,
		612,0,614,0,616,0,618,0,620,0,622,0,624,0,626,0,628,0,630,0,632,0,634,0,636,0,638,0,640,0,642,0,644,0,646,0,648,0,650,0,652,0,654,0,656,0,658,0,660,0,662,
		0,664,0,666,0,668,0,670,0,672,0,674,0,676,0,678,0,680,0,682,0,684,0,686,0,688,0,690,0,692,0,694,0,696,0,698,0,700,0,702,0,704,0,706,0,708,0,710,0,712,0,
		714,0,716,0,718,0,720,0,722,0,724,0,726,0,728,0,730,0,732,0,734,0,736,0,738,0,740,0,742,0,744,0,746,0,748,0,750,0,752,0,754,755,0,757,758,0,760,761,0,763,764,
		0,766,767,0,769,770,0,772,773,0,775,776,0,778,779,0,781,782,0,784,785,0,787,788,0,790,791,0,793,794,0,796,797,0,799,800,0,802,803,0,805,806,0,808,809,0,811,812,0,814,815,
		0,817,818,0,820,821,0,823,824,0,826,0,828,0,830,0,832,0,834,0,836,0,838,0,840,0,842,0,844,0,846,0,848,0,850,0,852,0,854,0,856,0,858,0,860,0,862,0,864,0,866,
		0,868,0,870,0,872,0,874,875,0,877,878,0,880,881,0,883,884,0,886,887,0,889,890,0,892,893,0,895,896,0,898,899,0,901,902,0,904,905,0,907,908,0,910,911,0,913,914,0,916,917,
		0,919,920,0,922,923,0,925,926,0,928,929,0,931,932,0,934,935,0,937,938,0,940,941,0,943,944,0,946,947,0,949,950,0,952,953,0,955,956,0,958,959,0,961,962,963,0,965,966,967,0,
		969,970,971,0,973,974,975,0,977,978,979,0,981,0,983,0,985,0,0,0,0,0,0,0,0,0,0,996,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
		0,0,0,0,0,0,0,0,0,1029,0,0,0,1033,0,0,0,1037,0,0,0,1041,0,0,0,1045,0,1047,0,0,0,0,0,1053,0,1055,1056,0,1058,1059,0,1061,1062,0,0,0,0,0,0,1069,0,
		0,0,1073,0,1075,1076,0,1078,0,0,1081,0,0,1084,0,0,1087,0,1089,0,0,0,0,1094,0,0,1097,0,0,1100,0,0,1103,0,1105,0,1107,0,0,0,0,1112,0,1114,0,1116,0,0,0,0,1121,
		0,0,1124,1125,0,0,1128,0,1130,1131,0,0,1134,0,1136,1137,0,1139,0,0,1142,1143,0,1145,0,1147,0,1149,1150,0,1152,1153,0,1155,0,1157,0,1159,0,1161,0,1163,1164,0,1166,0,0,0,0,0,0,
		0,0,0,0,0,0,0,1180,0,0,0,0,1185,0,1187,0,1189,0,0,0,0,0,1195,1196,0,1198,0,1200,0,1202,0,1204,0,1206,0,1208,0,1210,0,1212,0,1214,0,1216,0,1218,0,1220,0,1222,1223,
		0,1225,0,1227,0,1229,0,1231,1232,0,1234,1235,0,1237,1238,0,1240,0,1242,0,1244,0,1246,0,1248,0,0,0,0,0,0,0,0,0,0,0,0,1261,0,0,1264,0,0,1267,0,0,0,1271,0,0,0,
		0,0,1277,1278,0,1280,0,1282,0,1284,0,1286,0,1288,0,1290,0,1292,0,1294,0,1296,0,1298,0,1300,0,1302,1303,0,1305,0,1307,1308,0,1310,0,1312,1313,0,1315,0,1317,0,1319,1320,0,1322,0,1324,0,
		1326,0,1328,0,1330,0,1332,0,1334,0,1336,0,1338,0,1340,1341,0,1343,1344,0,1346,1347,0,1349,1350,0,1352,1353};

// Mapeamento de eventos não controláveis como entradas
#define b1 4	// Entrada 0
#define b2 5	// Entrada 1
#define b3 6	// Entrada 2
#define b4 7	// Entrada 3

// Mapeamento de eventos controláveis
#define a1 0
#define a2 1
#define a3 2
#define a4 3

// Definição dos eventos de saída
#define M1_ON  P2OUT |= BIT0    // Saida 0 ON
#define M1_OFF P2OUT &=~BIT0    // Saida 0 OFF
#define B_ON  P2OUT |= BIT1 // Saida 1 ON
#define B_OFF P2OUT &=~BIT1 // Saida 1 OFF
#define M2_ON  P2OUT |= BIT2    // Saida 2 ON
#define M2_OFF P2OUT &=~BIT2    // Saida 2 OFF
#define M3_ON  P2OUT |= BIT3    // Saida 3 ON
#define M3_OFF P2OUT &=~BIT3    // Saida 3 OFF
#define MESA_ON  P2OUT |= BIT4  // Saida 4 ON
#define MESA_OFF P2OUT &=~BIT4  // Saida 4 OFF
#define M4_ON  P2OUT |= BIT5    // Saida 5 ON
#define M4_OFF P2OUT &=~BIT5    // Saida 5 OFF
#define F_ON  P2OUT |= BIT7 // Saida 7 ON
#define F_OFF P2OUT &=~BIT7 // Saida 7 OFF

//Definição de funções de inicialização
void config_clk(void);		//Configura Clock
void config_timer(void);		//Configura Timer
void config_io(void);		//Configura entradas e saídas
void tempo_ms(unsigned int);	// Função de temporização do timer A em milisegundos
void delay_ms(unsigned int);	// Função delay em milisegundos para debounce

//Declaração de variáveis globais
unsigned int buffer[BUFFER];		//Buffer para armazenar a fila de eventos externos
unsigned int n_buffer=0;		//Número de eventos no Buffer

void main(void)
{
	WDTCTL = WDTPW + WDTHOLD;		//Desabilita o WDT
	config_clk();				//configura o clk
	config_timer();			//configura o timer
	config_io();				//configura entradas e saídas
	unsigned int k;
	int occur_event;			//Evento ocorrido
	unsigned int current_state = 0;	//Estado atual inicializado com estado inicial
	char g=0; 			//Flag para gerador aleatório de eventos
	char gerar_evento=1;			//Flag para habilitar a temporização de eventos controláveis
	char mealy_output = 0;		//Inicializa saída periférica
	__enable_interrupt();		//Habilita interrupção geral

	while(1)
	{

		if(n_buffer == 0)//se não existir evento no buffer então gerar um evento interno(evento controlável)
		{
			if(TACTL&TAIFG)	//Se o timer estourar, habilita a geração de eventos 
			{
				gerar_evento=1;
			}
			if(gerar_evento==1)
			{
				switch(g)	//Aqui é implementado um gerador automático de eventos controláveis
				{
					case(0):
						occur_event=a1;
						g++;
						break;
					case(1):
						occur_event=a2;
						g++;
						break;
					case(2):
						occur_event=a3;
						g++;
						break;
					case(3):
						occur_event=a4;
						g=0;
						break;
				}
			}
		}

		else 	//se existir evento não controlável pegar do buffer
		{
			occur_event = buffer[0];
			n_buffer--;
			k = 0;
			while(k<n_buffer)
			{
				buffer[k] = buffer[k+1];
				k+=1;
			}
		}


		//Jogador de autômato
		k = rfirst[current_state];
		if(k==0)
		{
			return;     //Dead Lock!!!
		}
		else
		{
			while(k>0)
			{
				k-=1;
				if(event[k] == occur_event)
				{
					current_state = in_state[k];
					mealy_output = 1;
					break;
				}
				k = rnext[k];
			}
		}

		if(mealy_output) //Se o evento ocorrido for válido, então imprimir saída física
		{
			switch(occur_event)
			{
				//eventos controláveis
				case(a1):	//Adicionar Ação para o Evento a1;
				        M1_ON;

					break;
				case(a2):	//Adicionar Ação para o Evento a2;
				        B_OFF;
				        M2_ON;

					break;
				case(a3):	//Adicionar Ação para o Evento a3;
				        M3_ON;
				        B_OFF;

					break;
				case(a4):	//Adicionar Ação para o Evento a4;
				        M4_ON;
				        MESA_OFF;

					break;
				//eventos não controláveis
				case(b1):	//Adicionar Ação para o Evento b1;
                        M1_OFF;
                        B_ON;
                        F_OFF;
                        tempo_ms(1000);
                        gerar_evento=0;

					break;
				case(b2):	//Adicionar Ação para o Evento b2;
                        M2_OFF;
                        MESA_ON;
                        F_OFF;
                        tempo_ms(1000);
                        gerar_evento=0;

					break;
				case(b3):	//Adicionar Ação para o Evento b3;
                        M3_OFF;
                        MESA_ON;
                        F_OFF;
                        tempo_ms(1000);
                        gerar_evento=0;

					break;
				case(b4):	//Adicionar Ação para o Evento b4;
                        M4_OFF;
                        F_ON;
                        tempo_ms(1000);
                        gerar_evento=0;

					break;
			}//fim switch
			mealy_output = 0;
			occur_event = -1;
		}//fim if(mealy_output)
	}//fim while(1)
}//fim main


//Tratamento da Interrupção da porta P1
//--------------------------------------------------------------
//--------------------------------------------------------------
#pragma vector=PORT1_VECTOR
__interrupt void RTI_PORT1(void)
{
	//delay_ms(10);  // Debounce: ajustar conforme necessidade. Se necessário descomentar
	if(P1IFG&BIT0)	//verifica se P1.0 foi pressionado
	{
		P1IFG&=~BIT0;		//apaga o flag
		buffer[n_buffer]=b1;	//Atribuir evento a P1.0
		if(n_buffer<BUFFER-1) n_buffer++;
	}
	if(P1IFG&BIT1)	//verifica se P1.1 foi pressionado
	{
		P1IFG&=~BIT1;		//apaga o flag
		buffer[n_buffer]=b2;	//Atribuir evento a P1.1
		if(n_buffer<BUFFER-1) n_buffer++;
	}
	if(P1IFG&BIT2)	//verifica se P1.2 foi pressionado
	{
		P1IFG&=~BIT2;		//apaga o flag
		buffer[n_buffer]=b3;	//Atribuir evento a P1.2
		if(n_buffer<BUFFER-1) n_buffer++;
	}
	if(P1IFG&BIT3)	//verifica se P1.3 foi pressionado
	{
		P1IFG&=~BIT3;		//apaga o flag
		buffer[n_buffer]=b4;	//Atribuir evento a P1.3
		if(n_buffer<BUFFER-1) n_buffer++;
	}
	P1IFG=0;
}


//Configuração de periféricos
//--------------------------------------------------------------
//--------------------------------------------------------------
void config_clk(void)	//configura o clock
{
	//O clock foi configurado a partir do DCO para SMCLK=16Mhz
	DCOCTL = 0x00;
	__delay_cycles(100000);
	BCSCTL1 = CALBC1_16MHZ;  // Carrega a calibração do DCO para 16 MHz
	DCOCTL = CALDCO_16MHZ;   // Define o DCO para 16 MHz
}

//--------------------------------------------------------------
//--------------------------------------------------------------
void config_timer(void)	//configura o timer
{
	//Configura o timer se necessário
	//para este caso será utilizado o Timer A com temporização de eventos
	//f_ref aprox = (VLOCLK)12e3/4 = 3kHz
	//TASSEL_1 -- ACLK
	//ID_2 -- Divide - /4
	//MC_1 -- contagem até TACCR0
	TACTL = TASSEL_1 + ID_2 + MC_1;
	BCSCTL3 |= LFXT1S1;	//coloca como fonte de clk o VLOCLK ao invés do cristal oscilador externo
}

//--------------------------------------------------------------
//--------------------------------------------------------------
void config_io(void)	//configura entradas e saídas
{
	//Por default a porta 1 será considerada entrada e a porta 2 saída
	P1DIR = 0;		//toda a porta P1 como entrada
	P1REN |= BIT0+BIT1+BIT2+BIT3+BIT4+BIT5+BIT6+BIT7;	//habilita resistores de pull(up/down)
	P1OUT |= BIT0+BIT1+BIT2+BIT3+BIT4+BIT5+BIT6+BIT7;	//pull UP
	P1IE  |= BIT0+BIT1+BIT2+BIT3+BIT4+BIT5+BIT6+BIT7;	//habilita interrupção das entradas P1
	P1IES |= BIT0+BIT1+BIT2+BIT3+BIT4+BIT5+BIT6+BIT7;	//a borda de descida que provoca interrupção (descida = 1 - subida = 0)
	//P1IES &= ~(BIT0+BIT1+BIT2+BIT3+BIT4+BIT5+BIT6+BIT7);	//a borda de subida que provoca interrupção (descida = 1 - subida = 0)
	P1IFG = 0;			//Apaga o Flag da interrupção de todas as entradas
	P2SEL &= ~(BIT6 | BIT7); 					 //Bit 6 e 7 do P2 como IO 
	P2DIR |= BIT0+BIT1+BIT2+BIT3+BIT4+BIT5+BIT6+BIT7;	//toda a porta P2 como saída
	P2OUT = 0;			//todas as saídas em nível lógico 0
}

//--------------------------------------------------------------
//--------------------------------------------------------------
void tempo_ms(unsigned int tempo)	//Função de temporização do timer A
{
	TACTL|= TACLR;		//zera o timer A
	TACCR0 =3*tempo;	//especifica tempo de estouro
	TACTL &= ~TAIFG;	//zera o Flag do estouro do Timer
}

//--------------------------------------------------------------
//--------------------------------------------------------------
void delay_ms(unsigned int ms)	//Função delay em milisegundos
{
	while(ms--)
	{
		__delay_cycles(16000);  // 16.000 ciclos para 1ms com DCO a 16 MHz
	}
}
